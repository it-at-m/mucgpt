[project]
name = "mucgpt-core-service"
version = "1.2.5"
description = "a web interface for large language models for the public administration"
readme = "README.md"
requires-python= ">=3.10"
authors = [
    { name = "Michael Jaumann", email = "michael.jaumann@muenchen.de" },
    { name = "Paul Ilitz", email = "paul.ilitz@muenchen.de" },
]
maintainers = [
    { name = " ITM KICC", email = "itm.kicc@muenchen.de" },
    { name = "Michael Jaumann", email = "michael.jaumann@muenchen.de" },
    { name = "Paul Ilitz", email = "paul.ilitz@muenchen.de" },
]

dependencies = [
    "fastapi[standard]==0.116.1",
    "langchain==0.3.27",
    "langchain-core==0.3.72",
    "langchain_community==0.3.27",
    "langchain-openai==0.3.28",
    "openai==1.97.1",
    "langsmith==0.4.8",
    "joserfc",
    "pypdf==5.9.0",
    "uvicorn==0.35.0",
    "asgi-correlation-id==4.3.4",
    "gitpython==3.1.45",
    "pydantic-settings>=2.8.1",
    "langgraph>=0.5.1",
    "truststore>=0.10.1",
    "langfuse>=3.2.1",
]

[tool.uv]
dev-dependencies = [
    "ipykernel==6.30.0",
    "pre-commit==4.2.0",
    "ruff==0.12.5",
    "pytest-env",
    "pytest",
    "pytest-asyncio",
    "pytest-snapshot",
    "pytest-mock",
    "coverage==7.8.2",
    "pytest-cov"
]

[[tool.uv.index]]
name = "pypy"
url = "https://pypi.org/simple"

[tool.ruff]
target-version = "py38"
src = ["src"]

[tool.ruff.lint]
select = ["E", "F", "I", "UP"]
ignore = ["E501", "E701"] # line too long, multiple statements on one line

[tool.pytest.ini_options]
addopts = "--strict-markers --strict-config --verbose --tb=short -ra --cov=src"
pythonpath = ["src/"]
testpaths = [
    "tests"]
markers = [
    "integration: mark a test as a integration test",
    "unit: mark test as a unit test"
]
env = [
    "MUCGPT_CORE_LOG_CONFIG=src/logconf.yaml",
    "MUCGPT_CORE_VERSION=0.0",
    "MUCGPT_CORE_COMMIT=12012lf",
    '''MUCGPT_CORE_BACKEND__MODELS=[{{"type": "AZURE", "llm_name": "mucgpt-test-model", "deployment": "mucgpt-test-model", "endpoint": "https://testprovider.api", "api_key": "blub", "max_output_tokens": 16384, "max_input_tokens": 128000, "description": "Model developed by kicc. "}}]''',
    "GIT_PYTHON_REFRESH=quiet"
]

[tool.coverage.paths]
source = ["scripts", "src"]

[tool.coverage.report]
show_missing = true
